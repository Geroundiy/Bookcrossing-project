<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>–û—Ç–∑—ã–≤ | BookCrossing</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

  <style>
    /* ==============================
       –§–û–ù ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
       –∏–∑ static/images/main_bg.png
       ============================== */
    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background:
              linear-gradient(rgba(245, 245, 240, 0.82), rgba(245, 245, 240, 0.82)),
              url('/images/main_bg.png') no-repeat center center fixed;
      background-size: cover;
      font-family: 'Segoe UI', system-ui, sans-serif;
      margin: 0;
      padding: 20px;
    }

    /* ==============================
       –ö–ê–†–¢–û–ß–ö–ê –§–û–†–ú–´
       ============================== */
    .review-card {
      background: #ffffff;
      border-radius: 20px;
      padding: 2.5rem 2.2rem;
      box-shadow:
              0 2px 8px rgba(0,0,0,0.06),
              0 12px 40px rgba(0,0,0,0.1);
      max-width: 500px;
      width: 100%;
      text-align: center;
    }

    .review-card .book-cover {
      width: 80px;
      height: 110px;
      object-fit: cover;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      margin-bottom: 1rem;
    }

    .review-card h2 {
      font-size: 1.3rem;
      font-weight: 700;
      color: #1a1a2e;
      margin-bottom: 0.25rem;
    }

    .book-meta {
      color: #6b7280;
      font-size: 0.88rem;
      margin-bottom: 1.8rem;
    }

    /* ==============================
       –ó–í–Å–ó–î–ù–´–ô –†–ï–ô–¢–ò–ù–ì
       CSS-only: direction:rtl + :checked ~ label
       ============================== */
    .star-rating-wrap {
      display: flex;
      justify-content: center;
      margin-bottom: 0.5rem;
    }

    .star-rating-group {
      display: inline-flex;
      flex-direction: row-reverse; /* –ö–ª—é—á –∫ CSS-only hover */
      gap: 6px;
    }

    .star-rating-group input[type="radio"] {
      display: none;
    }

    .star-rating-group label {
      font-size: 2.6rem;
      color: #d1d5db;
      cursor: pointer;
      transition: color 0.15s ease, transform 0.1s ease;
      line-height: 1;
    }

    .star-rating-group label::before {
      content: "\2605"; /* ‚òÖ */
    }

    /* –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
    .star-rating-group input:checked ~ label,
    .star-rating-group label:hover,
    .star-rating-group label:hover ~ label {
      color: #f59e0b;
      transform: scale(1.12);
    }

    /* –°–±—Ä–æ—Å –ø—Ä–∏ —Ö–æ–≤–µ—Ä–µ –ø–æ –≥—Ä—É–ø–ø–µ */
    .star-rating-group:hover label {
      color: #d1d5db;
      transform: scale(1);
    }
    .star-rating-group:hover label:hover,
    .star-rating-group:hover label:hover ~ label {
      color: #f59e0b;
      transform: scale(1.12);
    }

    .rating-hint {
      font-size: 0.8rem;
      color: #9ca3af;
      margin-bottom: 1.5rem;
      height: 1rem;
    }

    /* ==============================
       –ü–û–õ–ï –ö–û–ú–ú–ï–ù–¢–ê–†–ò–Ø
       ============================== */
    .review-card textarea {
      border: 1.5px solid #e5e7eb;
      border-radius: 12px;
      padding: 12px 14px;
      font-size: 0.92rem;
      resize: none;
      width: 100%;
      transition: border-color 0.2s;
      font-family: inherit;
    }

    .review-card textarea:focus {
      outline: none;
      border-color: #3b5bdb;
      box-shadow: 0 0 0 3px rgba(59, 91, 219, 0.1);
    }

    /* ==============================
       –ö–ù–û–ü–ö–ò
       ============================== */
    .btn-submit {
      background: #3b5bdb;
      color: #fff;
      border: none;
      border-radius: 50px;
      padding: 12px 0;
      width: 100%;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s, transform 0.1s, box-shadow 0.2s;
      margin-top: 1rem;
    }

    .btn-submit:hover {
      background: #2f4abf;
      transform: translateY(-1px);
      box-shadow: 0 4px 14px rgba(59, 91, 219, 0.35);
    }

    .btn-submit:active {
      transform: translateY(0);
    }

    .link-back {
      display: inline-block;
      margin-top: 1rem;
      color: #9ca3af;
      font-size: 0.85rem;
      text-decoration: none;
      transition: color 0.2s;
    }

    .link-back:hover {
      color: #3b5bdb;
    }

    /* –û—à–∏–±–∫–∞ */
    .error-msg {
      background: #fef2f2;
      border: 1px solid #fca5a5;
      color: #dc2626;
      border-radius: 10px;
      padding: 10px 14px;
      font-size: 0.88rem;
      margin-bottom: 1.2rem;
      text-align: left;
    }
  </style>
</head>
<body>

<div class="review-card">

  <!-- –û–±–ª–æ–∂–∫–∞ –∫–Ω–∏–≥–∏ -->
  <img th:src="${book.imageDisplay}"
       class="book-cover"
       alt="–û–±–ª–æ–∂–∫–∞"
       onerror="this.src='https://via.placeholder.com/80x110?text=üìñ'">

  <h2 th:text="${book.title}">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏</h2>
  <p class="book-meta" th:text="${book.author}">–ê–≤—Ç–æ—Ä</p>

  <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ (–µ—Å–ª–∏ —Ä–µ–π—Ç–∏–Ω–≥ –Ω–µ –≤—ã–±—Ä–∞–Ω) -->
  <div class="error-msg" th:if="${error}" th:text="${error}"></div>

  <form th:action="@{/reviews/add}" method="post">
    <!-- bookId –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —è–≤–Ω–æ –∫–∞–∫ hidden input -->
    <input type="hidden" name="bookId" th:value="${book.id}">

    <!-- ====== –ó–í–Å–ó–î–ù–´–ô –†–ï–ô–¢–ò–ù–ì ====== -->
    <div class="star-rating-wrap">
      <fieldset class="star-rating-group" id="starGroup">
        <input type="radio" id="star5" name="rating" value="5" required>
        <label for="star5" title="–û—Ç–ª–∏—á–Ω–æ"></label>

        <input type="radio" id="star4" name="rating" value="4">
        <label for="star4" title="–•–æ—Ä–æ—à–æ"></label>

        <input type="radio" id="star3" name="rating" value="3">
        <label for="star3" title="–ù–æ—Ä–º–∞–ª—å–Ω–æ"></label>

        <input type="radio" id="star2" name="rating" value="2">
        <label for="star2" title="–ü–ª–æ—Ö–æ"></label>

        <input type="radio" id="star1" name="rating" value="1">
        <label for="star1" title="–£–∂–∞—Å–Ω–æ"></label>
      </fieldset>
    </div>

    <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∞ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ -->
    <p class="rating-hint" id="ratingHint">–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ü–µ–Ω–∫—É</p>

    <!-- ====== –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô ====== -->
    <textarea name="comment"
              rows="4"
              placeholder="–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ–º –æ –∫–Ω–∏–≥–µ..."
              required
              maxlength="1000"></textarea>

    <button type="submit" class="btn-submit">
      <i class="fas fa-paper-plane me-2"></i>–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –æ—Ç–∑—ã–≤
    </button>
  </form>

  <a th:href="@{/}" class="link-back">
    <i class="fas fa-arrow-left me-1"></i>–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∫–∞—Ç–∞–ª–æ–≥
  </a>
</div>

<script>
  // –ü–æ–¥—Å–∫–∞–∑–∫–∞ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –æ—Ü–µ–Ω–∫–∏
  const hints = {
    '1': '–£–∂–∞—Å–Ω–æ',
    '2': '–ü–ª–æ—Ö–æ',
    '3': '–ù–æ—Ä–º–∞–ª—å–Ω–æ',
    '4': '–•–æ—Ä–æ—à–æ',
    '5': '–û—Ç–ª–∏—á–Ω–æ!'
  };

  document.querySelectorAll('.star-rating-group input[type="radio"]').forEach(function(radio) {
    radio.addEventListener('change', function() {
      document.getElementById('ratingHint').textContent = hints[this.value] || '';
    });
  });

  // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –ª–µ–π–±–ª–æ–≤ –ø—Ä–∏ —Ö–æ–≤–µ—Ä–µ (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∫ CSS)
  document.querySelectorAll('.star-rating-group label').forEach(function(label) {
    label.addEventListener('mouseenter', function() {
      const val = this.getAttribute('for').replace('star', '');
      document.getElementById('ratingHint').textContent = hints[val] || '';
    });
    label.addEventListener('mouseleave', function() {
      const checked = document.querySelector('.star-rating-group input:checked');
      document.getElementById('ratingHint').textContent =
              checked ? hints[checked.value] : '–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ü–µ–Ω–∫—É';
    });
  });
</script>

</body>
</html>